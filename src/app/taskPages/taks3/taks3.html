<div class="container mt-4">
  <div class="card shadow-sm wrapper">
    <div class="card-body">
      <h3 class="card-title text-center mb-3">Graph Algorithms Visualizer</h3>

      <div class="mb-4">
        <h6>Quick Examples:</h6>
        <div class="d-flex gap-2 flex-wrap mb-3">
          <button class="btn btn-outline-primary btn-sm" (click)="loadExample1()">Example 1: Linear</button>
          <button class="btn btn-outline-primary btn-sm" (click)="loadExample2()">Example 2: Tree</button>
        </div>
      </div>

      <div class="row g-2 mb-3">
        <div class="col-md-4">
          <label class="form-label small">Node ID:</label>
          <input type="text" class="form-control" placeholder="e.g., A, B, C..." [(ngModel)]="inputNode" />
        </div>
        <div class="col-md-4">
          <label class="form-label small">Connected Nodes:</label>
          <input type="text" class="form-control" placeholder="e.g., B,C (comma separated)" [(ngModel)]="inputEdges" />
        </div>
        <div class="col-md-4 d-flex gap-2 flex-wrap align-items-end">
          <button class="btn btn-primary" (click)="addNode()">Add Node</button>
          <button class="btn btn-outline-danger" (click)="clearGraph()">Clear All</button>
        </div>
      </div>

      <div class="mb-3">
        <label for="startNode" class="form-label">Start Node:</label>
        <select id="startNode" class="form-select" [(ngModel)]="startNode">
          <option value="">Select start node</option>
          <option *ngFor="let n of nodes" [value]="n.id">{{n.label}}</option>
        </select>
      </div>

      <div class="d-flex gap-2 flex-wrap mb-3 justify-content-center">
        <button class="btn btn-primary" (click)="runDFSVisual(startNode)" 
                [disabled]="!startNode || nodes.length === 0 || isRunning">
          ğŸ¯ Run DFS Visual
        </button>
        <button class="btn btn-success" (click)="runBFSVisual(startNode)"
                [disabled]="!startNode || nodes.length === 0 || isRunning">
          ğŸ”„ Run BFS Visual
        </button>
      </div>


      <div class="graph-container mb-3" style="height: 500px; border: 1px solid #dee2e6; border-radius: 0.375rem; overflow: auto;">
        <svg width="100%" height="100%" style="background: #f8f9fa;">
          <g *ngFor="let link of links">
            <line 
              [attr.x1]="getNodeX(link.source)" 
              [attr.y1]="getNodeY(link.source)"
              [attr.x2]="getNodeX(link.target)" 
              [attr.y2]="getNodeY(link.target)"
              [attr.stroke]="link.color" 
              stroke-width="2"
            />
          </g>

          <g *ngFor="let node of nodes">
            <circle 
              [attr.cx]="node.x || 0" 
              [attr.cy]="node.y || 0" 
              r="20" 
              [attr.fill]="node.color"
              stroke="#333" 
              stroke-width="2"
              style="cursor: move;"
              (mousedown)="onNodeDrag($event, node)"
            />
            <text 
              [attr.x]="node.x || 0" 
              [attr.y]="(node.y || 0) + 5" 
              text-anchor="middle" 
              fill="white" 
              font-size="12"
              font-weight="bold"
              style="pointer-events: none;"
            >
              {{ node.label }}
            </text>
          </g>
        </svg>
      </div>

      <div class="mb-3">
        <div class="d-flex gap-3 justify-content-center small">
          <div><span class="badge bg-primary">â—</span> <p>Unvisited</p></div>
          <div><span class="badge bg-danger">â—</span> <p>Currently Visiting</p></div>
          <div><span class="badge bg-success">â—</span> <p>Visited</p></div>
          <div><span class="badge bg-warning">â€”</span> <p>Active Edge</p></div>
          <div><span class="text-muted">ğŸ’¡ <p>Drag nodes to reposition</p></span></div>
        </div>
      </div>

      <div class="mt-3">
        <h5>Traversal Order:</h5>
        <div class="border rounded p-3 bg-light">
          <div *ngIf="output.length === 0" class="text-muted text-center">
            Run an algorithm to see traversal order...
          </div>
          <div *ngFor="let node of output; let i = index" class="d-inline-block me-2 mb-1">
            <span class="badge" [class]="getNodeBadgeClass(i)">{{ node }}</span>
            <span *ngIf="i < output.length - 1" class="text-muted mx-1">â†’</span>
          </div>
        </div>
      </div>

      <div class="mt-2 text-center">
        <small [class]="isRunning ? 'text-warning' : 'text-success'">
          {{ isRunning ? 'â³ Algorithm running...' : 'âœ… Ready' }}
        </small>
      </div>
    </div>
  </div>
</div>